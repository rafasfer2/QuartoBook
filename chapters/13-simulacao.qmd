# Simula√ß√£o Monte Carlo Aplicada √† Confiabilidade

## Introdu√ß√£o

Uso de simula√ß√£o Monte Carlo para avaliar confiabilidade e pol√≠ticas de manuten√ß√£o sob incerteza.

## Conceitos B√°sicos

### M√©todo Monte Carlo

1. Definir modelo matem√°tico
2. Identificar vari√°veis aleat√≥rias
3. Gerar amostras aleat√≥rias
4. Calcular resultados para cada amostra
5. Analisar distribui√ß√£o dos resultados

## Simula√ß√£o de Tempos de Vida

### Distribui√ß√£o Weibull

```{r}
#| label: simulacao-weibull
#| warning: false

library(tidyverse)

set.seed(123)

# Par√¢metros
beta <- 2
eta <- 1000
n_sim <- 10000

# Simular tempos de falha
tempos_falha <- rweibull(n_sim, shape = beta, scale = eta)

# Visualizar
df_sim <- data.frame(tempo = tempos_falha)

ggplot(df_sim, aes(x = tempo)) +
  geom_histogram(aes(y = after_stat(density)),
                 bins = 50, fill = "steelblue", alpha = 0.7) +
  stat_function(fun = dweibull,
                args = list(shape = beta, scale = eta),
                color = "red", linewidth = 1.2) +
  labs(title = "Simula√ß√£o Monte Carlo - Weibull",
       x = "Tempo at√© Falha", y = "Densidade") +
  theme_minimal()
```

### Estat√≠sticas Simuladas

```{r}
#| label: estatisticas-sim

# Comparar com valores te√≥ricos
MTTF_teorico <- eta * gamma(1 + 1/beta)
MTTF_simulado <- mean(tempos_falha)

cat("MTTF Te√≥rico:", round(MTTF_teorico, 2), "\n")
cat("MTTF Simulado:", round(MTTF_simulado, 2), "\n")
cat("Erro relativo:", round(abs(MTTF_teorico - MTTF_simulado)/MTTF_teorico * 100, 2), "%\n")
```

## Simula√ß√£o de Sistemas Complexos

### Sistema S√©rie

```{r}
#| label: sim-sistema-serie

# Simular sistema com 3 componentes em s√©rie
n_comp <- 3
n_sim <- 5000

# Par√¢metros de cada componente
params <- data.frame(
  comp = 1:n_comp,
  beta = c(2, 2.5, 1.8),
  eta = c(1000, 1200, 900)
)

# Simular
set.seed(456)
falhas_sistema <- replicate(n_sim, {
  tempos_comp <- mapply(rweibull,
                        n = 1,
                        shape = params$beta,
                        scale = params$eta)
  min(tempos_comp)  # Sistema s√©rie: falha no primeiro componente
})

# MTTF do sistema
cat("MTTF Sistema S√©rie:", round(mean(falhas_sistema), 2), "h\n")

# Visualizar
data.frame(tempo = falhas_sistema) %>%
  ggplot(aes(x = tempo)) +
  geom_histogram(bins = 50, fill = "coral", alpha = 0.7) +
  labs(title = "Distribui√ß√£o de Tempos de Falha - Sistema S√©rie",
       x = "Tempo at√© Falha do Sistema", y = "Frequ√™ncia") +
  theme_minimal()
```

## Avalia√ß√£o de Pol√≠ticas de Manuten√ß√£o

### Simula√ß√£o de Pol√≠tica Preventiva

```{r}
#| label: sim-politica-preventiva

# Fun√ß√£o para simular pol√≠tica de manuten√ß√£o
simular_manutencao <- function(T_preventivo, tempo_max,
                               beta, eta, C_prev, C_falha) {
  tempo_atual <- 0
  idade_componente <- 0
  custo_total <- 0
  n_prev <- 0
  n_falhas <- 0

  while (tempo_atual < tempo_max) {
    # Tempo at√© pr√≥xima falha
    tempo_falha <- rweibull(1, shape = beta, scale = eta)

    if (idade_componente + tempo_falha < T_preventivo) {
      # Falha antes da preventiva
      tempo_atual <- tempo_atual + tempo_falha + idade_componente
      custo_total <- custo_total + C_falha
      idade_componente <- 0
      n_falhas <- n_falhas + 1
    } else {
      # Preventiva executada
      tempo_atual <- tempo_atual + T_preventivo
      custo_total <- custo_total + C_prev
      idade_componente <- 0
      n_prev <- n_prev + 1
    }
  }

  list(
    custo_medio = custo_total / tempo_max,
    n_preventivas = n_prev,
    n_falhas = n_falhas
  )
}

# Par√¢metros
beta <- 2.5
eta <- 1000
C_prev <- 1000
C_falha <- 5000
tempo_max <- 50000

# Testar diferentes intervalos
intervalos <- seq(300, 1200, by = 50)

resultados <- lapply(intervalos, function(Tp) {
  replicate(100, {
    sim <- simular_manutencao(Tp, tempo_max, beta, eta, C_prev, C_falha)
    sim$custo_medio
  }) %>% mean()
})

df_politicas <- data.frame(
  intervalo = intervalos,
  custo_medio = unlist(resultados)
)

# Visualizar
ggplot(df_politicas, aes(x = intervalo, y = custo_medio)) +
  geom_line(color = "steelblue", linewidth = 1.2) +
  geom_point(data = df_politicas[which.min(df_politicas$custo_medio), ],
             color = "red", size = 4) +
  labs(title = "Otimiza√ß√£o por Simula√ß√£o Monte Carlo",
       x = "Intervalo Preventivo (h)",
       y = "Custo M√©dio por Hora") +
  theme_minimal()
```

## An√°lise de Incerteza

### Propaga√ß√£o de Incerteza

```{r}
#| label: incerteza-parametros

# Incerteza nos par√¢metros
n_sim <- 1000

# Distribui√ß√µes dos par√¢metros (baseadas em IC)
beta_sim <- rnorm(n_sim, mean = 2, sd = 0.2)
eta_sim <- rnorm(n_sim, mean = 1000, sd = 100)

# Calcular MTTF para cada combina√ß√£o
MTTF_sim <- eta_sim * gamma(1 + 1/beta_sim)

# Visualizar incerteza
data.frame(MTTF = MTTF_sim) %>%
  ggplot(aes(x = MTTF)) +
  geom_histogram(bins = 50, fill = "darkgreen", alpha = 0.7) +
  geom_vline(xintercept = median(MTTF_sim),
             color = "red", linetype = "dashed", linewidth = 1) +
  annotate("text", x = median(MTTF_sim) + 50, y = 50,
           label = paste("Mediana:", round(median(MTTF_sim), 1)),
           color = "red") +
  labs(title = "Incerteza no MTTF",
       x = "MTTF (h)", y = "Frequ√™ncia") +
  theme_minimal()

# IC 95%
ic <- quantile(MTTF_sim, c(0.025, 0.975))
cat("IC 95% para MTTF:", round(ic[1], 1), "-", round(ic[2], 1), "\n")
```

## Exerc√≠cios

üìù **Exerc√≠cio 1**: Simule sistema paralelo (redund√¢ncia).

üìù **Exerc√≠cio 2**: Compare pol√≠ticas age-based vs. block por simula√ß√£o.

üìù **Exerc√≠cio 3**: Analise impacto da incerteza param√©trica na decis√£o de manuten√ß√£o.

## Resumo

üîî **Pontos-chave:**

- Monte Carlo √© poderoso para sistemas complexos
- Permite avaliar pol√≠ticas sem f√≥rmulas anal√≠ticas
- Quantifica incerteza em decis√µes
- Adequado para otimiza√ß√£o de par√¢metros

---

**Pr√≥ximo cap√≠tulo:** Estudos de Caso Industriais
