# An√°lise de Sobreviv√™ncia e Modelos Semiparam√©tricos

## Introdu√ß√£o

An√°lise de sobreviv√™ncia com modelos de regress√£o, incluindo Kaplan-Meier e Cox.

## Modelo de Cox (Regress√£o de Riscos Proporcionais)

### Formula√ß√£o

$$
\lambda(t|X) = \lambda_0(t) \exp(\beta_1 X_1 + \beta_2 X_2 + \ldots + \beta_p X_p)
$$

onde $\lambda_0(t)$ √© a taxa de risco basal.

## Exemplo com Covari√°veis

```{r}
#| label: cox-model
#| warning: false

library(survival)
library(survminer)

# Dados de exemplo com covari√°veis
dados <- data.frame(
  tempo = c(120, 145, 180, 200, 250, 300, 350, 400, 450, 500,
            100, 130, 160, 190, 220, 280, 320, 380, 420, 480),
  status = c(1, 1, 1, 0, 1, 0, 1, 1, 0, 1,
             1, 1, 1, 1, 0, 1, 0, 1, 1, 1),
  temperatura = c(rep(70, 10), rep(90, 10)),  # ¬∞C
  carga = c(rep("Normal", 10), rep("Alta", 10))
)

# Ajustar modelo Cox
cox_model <- coxph(Surv(tempo, status) ~ temperatura + carga, data = dados)

summary(cox_model)
```

## Interpreta√ß√£o dos Coeficientes

```{r}
#| label: hazard-ratios

# Hazard ratios
exp(coef(cox_model))

# Intervalos de confian√ßa
exp(confint(cox_model))
```

## Verifica√ß√£o de Pressupostos

```{r}
#| label: cox-assumptions

# Teste de proporcionalidade
cox.zph(cox_model)

# Gr√°fico de res√≠duos
ggcoxzph(cox.zph(cox_model))
```

## Curvas de Sobreviv√™ncia por Grupo

```{r}
#| label: survival-curves

# Curvas ajustadas
fit_km <- survfit(Surv(tempo, status) ~ carga, data = dados)

ggsurvplot(fit_km,
           data = dados,
           pval = TRUE,
           conf.int = TRUE,
           risk.table = TRUE,
           palette = c("steelblue", "coral"),
           title = "Sobreviv√™ncia por N√≠vel de Carga")
```

## Modelos Param√©tricos AFT

```{r}
#| label: aft-model
#| eval: false

library(flexsurv)

# Modelo AFT Weibull
aft_weibull <- flexsurvreg(Surv(tempo, status) ~ temperatura + carga,
                            data = dados,
                            dist = "weibull")

summary(aft_weibull)
```

## Exerc√≠cios

üìù **Exerc√≠cio 1**: Ajuste modelo Cox com 3 covari√°veis.

üìù **Exerc√≠cio 2**: Compare modelo Cox vs. AFT.

üìù **Exerc√≠cio 3**: Interprete hazard ratios e seus IC.

## Resumo

üîî **Pontos-chave:**

- Modelo Cox n√£o requer especifica√ß√£o da distribui√ß√£o
- Hazard ratios quantificam efeito das covari√°veis
- Verificar pressupostos √© essencial

---

**Pr√≥ximo cap√≠tulo:** Manuten√ß√£o Preventiva
